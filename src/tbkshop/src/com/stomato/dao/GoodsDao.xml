<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.stomato.dao.GoodsDao">
	<resultMap type="com.stomato.domain.Goods" id="goods"> 
		<result property="id" column="id" />
		<result property="goodsCode" column="goods_code" />
		<result property="goodsName" column="goods_name"/>
		<result property="shopId" column="shop_id"/>
		<result property="brandId" column="brand_id"/>
		<result property="createrUid" column="creater_uid"/>
		<result property="cateId" column="cate_id"/>
		<result property="shopPrice" column="shop_price"/>
		<result property="marketPrice" column="market_price"/>
		<result property="commission" column="commission"/>
		<result property="goodsPic" column="goods_pic"/>
		<result property="brief" column="brief"/>
		<result property="content" column="content"/>
		<result property="likeNum" column="like_num"/>
		<result property="isTop" column="is_top"/>
		<result property="isHot" column="is_hot"/>
		<result property="indexHot" column="index_hot"/>
		<result property="status" column="status"/>
		<result property="preview" column="preview"/>
		<result property="sort" column="sort"/>
		<result property="keyword" column="keyword"/>
		<result property="stocks" column="stocks"/>
		<result property="goodsIcon" column="goods_icon"/>
		<result property="linkUrl" column="link_url"/>
		<result property="buys" column="buys"/>
		<result property="delFlag" column="del_flag"/>
		<result property="createtime" column="createtime"/>
		<result property="modifytime" column="modifytime"/>
	</resultMap>
	
	<insert id="add" parameterType="com.stomato.domain.Goods">
		insert into t_goods (
				goods_code,
				goods_name,
				display_name,
				shop_id,
				brand_id,
				creater_uid,
				cate_id,
				shop_price,
				market_price,
				commission,
				goods_pic,
				brief,
				content,
				like_num,
				is_top,
				is_hot,
				index_hot,
				status,
				preview,
				sort,
				keyword,
				stocks,
				goods_icon,
				link_url,
				buys,
				del_flag,
				createtime,
				modifytime) 
		values (
				#{goodsCode},
				#{goodsName},
				#{displayName},
				#{shopId},
				#{brandId},
				#{createrUid},
				#{cateId},
				#{shopPrice},
				#{marketPrice},
				#{commission},
				#{goodsPic},
				#{brief},
				#{content},
				#{likeNum},
				#{isTop},
				#{isHot},
				#{indexHot},
				0,
				#{preview},
				#{sort},
				#{keyword},
				#{stocks},
				#{goodsIcon},
				#{linkUrl},
				0,
				0,
				now(),
				now())
	</insert>
	
	<select id="get" parameterType="int" resultMap="goods" >
		select id,
				goods_code,
				goods_name,
				display_name,
				shop_id,
				brand_id,
				creater_uid,
				cate_id,
				shop_price,
				market_price,
				commission,
				goods_pic,
				brief,
				content,
				like_num,
				is_top,
				is_hot,
				index_hot,
				status,
				preview,
				sort,
				keyword,
				stocks,
				goods_icon,
				link_url,
				buys,
				del_flag,
				createtime,
				modifytime
				from t_goods where id=#{id} and del_flag = 0
	</select>
	<update id="update" parameterType="com.stomato.domain.Goods">
		update t_goods 
		<set>
			<if test="goodsCode != null">goods_code=#{goodsCode},</if>
			<if test="goodsName != null">goods_name=#{goodsName},</if>
			<if test="displayName != null">display_name=#{displayName},</if>
			<if test="shopId != null">shop_id=#{shopId},</if>
			<if test="brandId != null">brand_id=#{brandId},</if>
			<if test="createrUid != null">creater_uid=#{createrUid},</if>
			<if test="cateId != null">cate_id=#{cateId},</if>
			<if test="shopPrice != null">shop_price=#{shopPrice},</if>
			<if test="marketPrice != null">market_price=#{marketPrice},</if>
			<if test="commission != null">commission=#{commission},</if>
			<if test="goodsPic != null">goods_pic=#{goodsPic},</if>
			<if test="brief != null">brief=#{brief},</if>
			<if test="content != null">content=#{content},</if>
			<if test="likeNum != null">like_num=#{likeNum},</if>
			<if test="isTop != null">isTop=#{isTop},</if>
			<if test="isHot != null">isHot=#{isHot},</if>
			<if test="indexHot != null">indexHot=#{indexHot},</if>
			<if test="status != null">status=#{status},</if>
			<if test="preview != null">preview=#{preview},</if>
			<if test="sort != null">sort=#{sort},</if>
			<if test="keyword != null">keyword=#{keyword},</if>
			<if test="stocks != null">stocks=#{stocks},</if>
			<if test="goodsIcon != null">goods_icon=#{goodsIcon},</if>
			<if test="linkUrl != null">link_url=#{linkUrl},</if>
			<if test="buys != null">buys=#{buys},</if>
			<if test="delFlag != null">del_flag=#{delFlag},</if>
			modifytime=now()
		</set>
        where id = #{id} 
	</update>
	<delete id="delete" parameterType="int">
		delete from t_goods where id = #{id}
	</delete>
	
	<select id="listTotal" parameterType="com.stomato.form.GoodsFormParam" resultType="int" >
		select count(1) from t_goods where 1=1 and del_flag = 0
		<if test="goodsName != null">
		 	and goods_name like '%${goodsName}%'
		</if>
	</select>
	<select id="list" parameterType="com.stomato.form.GoodsFormParam" resultMap="goods" >
		select  id,
				goods_code,
				goods_name,
				display_name,
				shop_id,
				brand_id,
				creater_uid,
				cate_id,
				shop_price,
				market_price,
				commission,
				goods_pic,
				brief,
				content,
				like_num,
				is_top,
				is_hot,
				index_hot,
				status,
				preview,
				sort,
				keyword,
				stocks,
				goods_icon,
				link_url,
				buys,
				del_flag,
				createtime,
				modifytime
				from t_goods where 1=1 and del_flag = 0
		<if test="goodsName != null">
		 	and goods_name like '%${goodsName}%'
		</if>
		order by sort asc
		<if test="offset != null">limit #{offset},#{pageSize}</if>
	</select>
</mapper>